# OCP 4.19

# Component
- op: add
  path: /spec/resources/-
  value:
    apiVersion: appstudio.redhat.com/v1alpha1
    kind: Component
    metadata:
      annotations:
        build.appstudio.openshift.io/pipeline: '{"name":"fbc-builder","bundle":"latest"}'
        build.appstudio.openshift.io/status: '{"pac":{"state":"enabled","merge-url":"https://github.com/securesign/fbc/pull/97","configuration-time":"Thu,27 Mar 2025 12:35:34 UTC"},"message":"done"}'
        mintmaker.appstudio.redhat.com/disabled: "{{.mintmakerDisabled}}"
      name: "{{.application}}{{.nameSuffix}}-v4-19"
    spec:
      application: "{{.application}}{{.nameSuffix}}"
      componentName: "{{.application}}{{.nameSuffix}}-v4-19"
      source:
        git:
          context: "v4.19/{{.operator}}"
          dockerfileUrl: catalog.Dockerfile
          revision: "{{.branch}}"
          url: https://github.com/securesign/fbc

# IntegrationTestScenario E2E
- op: add
  path: /spec/resources/-
  value:
    apiVersion: appstudio.redhat.com/v1beta2
    kind: IntegrationTestScenario
    metadata:
      labels:
        test.appstudio.openshift.io/optional: "false"
      name: "{{.application}}{{.nameSuffix}}-v4-19-e2e"
    spec:
      application: "{{.application}}{{.nameSuffix}}"
      contexts:
        - description: execute the integration test when component {{.application}}{{.nameSuffix}}-v4-19 updates
          name: "component_{{.application}}{{.nameSuffix}}-v4-19"
      params:
        - name: OCP_VERSION
          value: "4.19"
      resolverRef:
        params:
          - name: url
            value: https://github.com/securesign/pipelines.git
          - name: revision
            value: main
          - name: pathInRepo
            value: pipelines/integration-test/rhtas-fbc-e2e.yaml
        resolver: git
        resourceKind: pipelinerun

# IntegrationTestScenario E2E
- op: add
  path: /spec/resources/-
  value:
    apiVersion: appstudio.redhat.com/v1beta2
    kind: IntegrationTestScenario
    metadata:
      labels:
        test.appstudio.openshift.io/optional: "false"
      name: "{{.application}}{{.nameSuffix}}-v4-19-e2e-fips"
    spec:
      application: "{{.application}}{{.nameSuffix}}"
      contexts:
        - description: execute the integration test when component {{.application}}{{.nameSuffix}}-v4-19 updates
          name: "component_{{.application}}{{.nameSuffix}}-v4-19"
      params:
        - name: OCP_VERSION
          value: "4.19"
        - name: FIPS_ENABLED
          value: "true"
        - name: CLUSTER_PLATFORM
          value: "openshift"
      resolverRef:
        params:
          - name: url
            value: https://github.com/securesign/pipelines.git
          - name: revision
            value: main
          - name: pathInRepo
            value: pipelines/integration-test/rhtas-fbc-e2e.yaml
        resolver: git
        resourceKind: pipelinerun

# IntegrationTestScenario Upgrade
- op: add
  path: /spec/resources/-
  value:
    apiVersion: appstudio.redhat.com/v1beta2
    kind: IntegrationTestScenario
    metadata:
      name: "{{.application}}{{.nameSuffix}}-v4-19-upgrade"
    spec:
      application: "{{.application}}{{.nameSuffix}}"
      contexts:
        - description: execute the integration test when component {{.application}}{{.nameSuffix}}-v4-19 updates
          name: "component_{{.application}}{{.nameSuffix}}-v4-19"
      params:
        - name: OCP_VERSION
          value: "4.19"
      resolverRef:
        params:
          - name: url
            value: https://github.com/securesign/pipelines.git
          - name: revision
            value: main
          - name: pathInRepo
            value: pipelines/integration-test/operator-upgrade.yaml
        resolver: git
        resourceKind: pipelinerun

# IntegrationTestScenario DAST
- op: add
  path: /spec/resources/-
  value:
    apiVersion: appstudio.redhat.com/v1beta2
    kind: IntegrationTestScenario
    metadata:
      name: "{{.application}}{{.nameSuffix}}-v4-19-dast"
    spec:
      application: "{{.application}}{{.nameSuffix}}"
      contexts:
        - description: execute the DAST test when component {{.application}}{{.nameSuffix}}-v4-19 updates
          name: "component_{{.application}}{{.nameSuffix}}-v4-19"
      resolverRef:
        params:
          - name: url
            value: https://github.com/securesign/pipelines.git
          - name: revision
            value: main
          - name: pathInRepo
            value: pipelines/integration-test/operator-dast.yaml
        resolver: git
        resourceKind: pipelinerun
